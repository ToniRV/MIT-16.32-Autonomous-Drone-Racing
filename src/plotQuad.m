% Wil Selby
% Washington, DC
% May 30, 2015
% Antoni Rosionl
% Cambridge, MA
% May 10, 2019

% This function draws the quadrotor model by rotating the original Body
% Frame coordinates used to define the quadrotor in plot_quad_model.m into
% Global Frame coordinates. It then moves the quadrotor to the current
% Global Position output from the quadrotor dynamics. In our NED coordinate
% frame, positive Z is negative Z in MATLAB and positive Y in negative Y in
% MATLAB. This is reflected iwth the - in the set function.

%% Draw the quadrotor arms and rotors
global Quad

%% Plot Rotors Arms
[Quad.Xtemp, Quad.Ytemp, Quad.Ztemp] = ...
rotateBFtoGF(Quad.QuadModel.X_armX, Quad.QuadModel.X_armY, Quad.QuadModel.X_armZ, ...
             Quad.State.phi, Quad.State.theta, Quad.State.psi);
set(Quad.X_arm, ...
    'xdata',   Quad.Xtemp + Quad.State.X, ...
    'ydata', (Quad.Ytemp + Quad.State.Y),...
    'zdata', (Quad.Ztemp + Quad.State.Z))

[Quad.Xtemp, Quad.Ytemp, Quad.Ztemp] = ...
    rotateBFtoGF(Quad.QuadModel.Y_armX, Quad.QuadModel.Y_armY, Quad.QuadModel.Y_armZ, ...
                 Quad.State.phi, Quad.State.theta, Quad.State.psi);
set(Quad.Y_arm, ...
    'xdata', Quad.Xtemp + Quad.State.X, ...
    'ydata', Quad.Ytemp + Quad.State.Y, ...
    'zdata', Quad.Ztemp + Quad.State.Z)

%% Plot Rotors Motors
[Quad.Xtemp, Quad.Ytemp, Quad.Ztemp] = ...
    rotateBFtoGF(Quad.QuadModel.Motor1X, Quad.QuadModel.Motor1Y, Quad.QuadModel.Motor1Z, ...
                 Quad.State.phi, Quad.State.theta, Quad.State.psi);
set(Quad.Motor1, ...
    'xdata', Quad.Xtemp + Quad.State.X, ...
    'ydata', Quad.Ytemp + Quad.State.Y, ...
    'zdata', Quad.Ztemp + Quad.State.Z)

[Quad.Xtemp,Quad.Ytemp,Quad.Ztemp]= ...
    rotateBFtoGF(Quad.QuadModel.Motor2X, Quad.QuadModel.Motor2Y, Quad.QuadModel.Motor2Z,...
    Quad.State.phi,Quad.State.theta,Quad.State.psi);
set(Quad.Motor2, ...
'xdata', Quad.Xtemp + Quad.State.X, ...
'ydata', Quad.Ytemp + Quad.State.Y, ...
'zdata', Quad.Ztemp + Quad.State.Z)

[Quad.Xtemp,Quad.Ytemp,Quad.Ztemp]= ...
    rotateBFtoGF(Quad.QuadModel.Motor3X,Quad.QuadModel.Motor3Y,Quad.QuadModel.Motor3Z,...
                 Quad.State.phi,Quad.State.theta,Quad.State.psi);
set(Quad.Motor3,...
    'xdata', Quad.Xtemp + Quad.State.X, ...
    'ydata', Quad.Ytemp + Quad.State.Y, ...
    'zdata', Quad.Ztemp + Quad.State.Z)

[Quad.Xtemp,Quad.Ytemp,Quad.Ztemp]= ...
rotateBFtoGF(Quad.QuadModel.Motor4X,Quad.QuadModel.Motor4Y,Quad.QuadModel.Motor4Z,...
    Quad.State.phi,Quad.State.theta,Quad.State.psi);
set(Quad.Motor4,...
    'xdata', Quad.Xtemp + Quad.State.X,...
    'ydata', Quad.Ytemp + Quad.State.Y,...
    'zdata', Quad.Ztemp + Quad.State.Z)



